apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: khushal-apps

resources:
  # Shared namespace
  - ../../base/namespace.yaml

  # Unified ingress for all apps
  - unified-ingress.yaml

  # Include both applications
  - ../../../tracc/overlays/aws
  - ../../../swaminarayan-timeline/overlays/aws

commonLabels:
  environment: production
  region: us-east-1
  managed-by: kustomize

# Shared ConfigMap for common settings
configMapGenerator:
  - name: shared-env-config
    literals:
      - AWS_REGION=us-east-1
      - ENVIRONMENT=production
      - NAMESPACE=khushal-apps
      - LOG_LEVEL=info

# Shared secrets (placeholders - use external secrets in production)
secretGenerator:
  - name: shared-app-secrets
    literals:
      - database-url=postgresql://user:pass@postgres.khushal-apps.svc.cluster.local:5432/shared_db
      - redis-url=redis://redis.khushal-apps.svc.cluster.local:6379